{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useEffect } from \"react\";\nimport axios from \"axios\";\nimport \"./Chatwoot.css\";\nconst BASE_URL = \"http://127.0.0.1:3000\"; // Your Chatwoot instance URL\nconst WEBHOOK_URL = \"http://localhost:3200/webhook\"; // Your backend endpoint\n\nconst ChatwootWidget = () => {\n  _s();\n  useEffect(() => {\n    (function (d, t) {\n      const scriptElem = d.createElement(t);\n      const firstScript = d.getElementsByTagName(t)[0];\n      scriptElem.src = BASE_URL + \"/packs/js/sdk.js\";\n      scriptElem.defer = true;\n      scriptElem.async = true;\n      firstScript.parentNode.insertBefore(scriptElem, firstScript);\n      scriptElem.onload = function () {\n        console.log(\"Chatwoot SDK loaded. Running configuration...\");\n        window.chatwootSDK.run({\n          websiteToken: \"BH9YQA553U754XQuLQmZYD5p\",\n          // Replace with your token\n          baseUrl: BASE_URL,\n          onMessage: async message => {\n            console.log(\"onMessage callback fired with:\", message);\n\n            // Check the message content and conversation id (adjust keys if needed)\n            const content = message.content;\n            const convId = message.conversation_id || message.conversationId;\n            console.log(\"Message content:\", content);\n            console.log(\"Conversation ID:\", convId);\n            if (content && content.trim().toLowerCase().startsWith(\"/ask\")) {\n              const queryText = content.trim().substring(4).trim();\n              console.log(\"Extracted Query Text:\", queryText);\n              try {\n                console.log(\"Sending POST request to webhook:\", WEBHOOK_URL);\n                await axios.post(WEBHOOK_URL, {\n                  payload: {\n                    content: content\n                  },\n                  conversation: {\n                    id: convId\n                  }\n                });\n                console.log(\"Webhook triggered successfully.\");\n              } catch (error) {\n                console.error(\"Error sending message to webhook:\", error);\n              }\n            }\n          }\n        });\n      };\n    })(document, \"script\");\n\n    // Alternative: Listen for a Chatwoot event (if onMessage is not firing)\n    window.addEventListener(\"chatwoot:message:received\", event => {\n      console.log(\"chatwoot:message:received event:\", event.detail);\n    });\n  }, []);\n  return null;\n};\n_s(ChatwootWidget, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n_c = ChatwootWidget;\nexport default ChatwootWidget;\nvar _c;\n$RefreshReg$(_c, \"ChatwootWidget\");","map":{"version":3,"names":["React","useEffect","axios","BASE_URL","WEBHOOK_URL","ChatwootWidget","_s","d","t","scriptElem","createElement","firstScript","getElementsByTagName","src","defer","async","parentNode","insertBefore","onload","console","log","window","chatwootSDK","run","websiteToken","baseUrl","onMessage","message","content","convId","conversation_id","conversationId","trim","toLowerCase","startsWith","queryText","substring","post","payload","conversation","id","error","document","addEventListener","event","detail","_c","$RefreshReg$"],"sources":["/Users/24khushi/Desktop/KBCHAT/client/src/Chatwoot.js"],"sourcesContent":["import React, { useEffect } from \"react\";\nimport axios from \"axios\";\nimport \"./Chatwoot.css\";\n\nconst BASE_URL = \"http://127.0.0.1:3000\";  // Your Chatwoot instance URL\nconst WEBHOOK_URL = \"http://localhost:3200/webhook\"; // Your backend endpoint\n\nconst ChatwootWidget = () => {\n  useEffect(() => {\n    (function (d, t) {\n      const scriptElem = d.createElement(t);\n      const firstScript = d.getElementsByTagName(t)[0];\n\n      scriptElem.src = BASE_URL + \"/packs/js/sdk.js\";\n      scriptElem.defer = true;\n      scriptElem.async = true;\n      firstScript.parentNode.insertBefore(scriptElem, firstScript);\n\n      scriptElem.onload = function () {\n        console.log(\"Chatwoot SDK loaded. Running configuration...\");\n        window.chatwootSDK.run({\n          websiteToken: \"BH9YQA553U754XQuLQmZYD5p\", // Replace with your token\n          baseUrl: BASE_URL,\n          onMessage: async (message) => {\n            console.log(\"onMessage callback fired with:\", message);\n\n            // Check the message content and conversation id (adjust keys if needed)\n            const content = message.content;\n            const convId = message.conversation_id || message.conversationId;\n            console.log(\"Message content:\", content);\n            console.log(\"Conversation ID:\", convId);\n\n            if (content && content.trim().toLowerCase().startsWith(\"/ask\")) {\n              const queryText = content.trim().substring(4).trim();\n              console.log(\"Extracted Query Text:\", queryText);\n              try {\n                console.log(\"Sending POST request to webhook:\", WEBHOOK_URL);\n                await axios.post(WEBHOOK_URL, {\n                  payload: { content: content },\n                  conversation: { id: convId },\n                });\n                console.log(\"Webhook triggered successfully.\");\n              } catch (error) {\n                console.error(\"Error sending message to webhook:\", error);\n              }\n            }\n          },\n        });\n      };\n    })(document, \"script\");\n\n    // Alternative: Listen for a Chatwoot event (if onMessage is not firing)\n    window.addEventListener(\"chatwoot:message:received\", (event) => {\n      console.log(\"chatwoot:message:received event:\", event.detail);\n    });\n  }, []);\n\n  return null;\n};\n\nexport default ChatwootWidget;\n"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,SAAS,QAAQ,OAAO;AACxC,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAO,gBAAgB;AAEvB,MAAMC,QAAQ,GAAG,uBAAuB,CAAC,CAAE;AAC3C,MAAMC,WAAW,GAAG,+BAA+B,CAAC,CAAC;;AAErD,MAAMC,cAAc,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC3BL,SAAS,CAAC,MAAM;IACd,CAAC,UAAUM,CAAC,EAAEC,CAAC,EAAE;MACf,MAAMC,UAAU,GAAGF,CAAC,CAACG,aAAa,CAACF,CAAC,CAAC;MACrC,MAAMG,WAAW,GAAGJ,CAAC,CAACK,oBAAoB,CAACJ,CAAC,CAAC,CAAC,CAAC,CAAC;MAEhDC,UAAU,CAACI,GAAG,GAAGV,QAAQ,GAAG,kBAAkB;MAC9CM,UAAU,CAACK,KAAK,GAAG,IAAI;MACvBL,UAAU,CAACM,KAAK,GAAG,IAAI;MACvBJ,WAAW,CAACK,UAAU,CAACC,YAAY,CAACR,UAAU,EAAEE,WAAW,CAAC;MAE5DF,UAAU,CAACS,MAAM,GAAG,YAAY;QAC9BC,OAAO,CAACC,GAAG,CAAC,+CAA+C,CAAC;QAC5DC,MAAM,CAACC,WAAW,CAACC,GAAG,CAAC;UACrBC,YAAY,EAAE,0BAA0B;UAAE;UAC1CC,OAAO,EAAEtB,QAAQ;UACjBuB,SAAS,EAAE,MAAOC,OAAO,IAAK;YAC5BR,OAAO,CAACC,GAAG,CAAC,gCAAgC,EAAEO,OAAO,CAAC;;YAEtD;YACA,MAAMC,OAAO,GAAGD,OAAO,CAACC,OAAO;YAC/B,MAAMC,MAAM,GAAGF,OAAO,CAACG,eAAe,IAAIH,OAAO,CAACI,cAAc;YAChEZ,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAEQ,OAAO,CAAC;YACxCT,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAES,MAAM,CAAC;YAEvC,IAAID,OAAO,IAAIA,OAAO,CAACI,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACC,UAAU,CAAC,MAAM,CAAC,EAAE;cAC9D,MAAMC,SAAS,GAAGP,OAAO,CAACI,IAAI,CAAC,CAAC,CAACI,SAAS,CAAC,CAAC,CAAC,CAACJ,IAAI,CAAC,CAAC;cACpDb,OAAO,CAACC,GAAG,CAAC,uBAAuB,EAAEe,SAAS,CAAC;cAC/C,IAAI;gBACFhB,OAAO,CAACC,GAAG,CAAC,kCAAkC,EAAEhB,WAAW,CAAC;gBAC5D,MAAMF,KAAK,CAACmC,IAAI,CAACjC,WAAW,EAAE;kBAC5BkC,OAAO,EAAE;oBAAEV,OAAO,EAAEA;kBAAQ,CAAC;kBAC7BW,YAAY,EAAE;oBAAEC,EAAE,EAAEX;kBAAO;gBAC7B,CAAC,CAAC;gBACFV,OAAO,CAACC,GAAG,CAAC,iCAAiC,CAAC;cAChD,CAAC,CAAC,OAAOqB,KAAK,EAAE;gBACdtB,OAAO,CAACsB,KAAK,CAAC,mCAAmC,EAAEA,KAAK,CAAC;cAC3D;YACF;UACF;QACF,CAAC,CAAC;MACJ,CAAC;IACH,CAAC,EAAEC,QAAQ,EAAE,QAAQ,CAAC;;IAEtB;IACArB,MAAM,CAACsB,gBAAgB,CAAC,2BAA2B,EAAGC,KAAK,IAAK;MAC9DzB,OAAO,CAACC,GAAG,CAAC,kCAAkC,EAAEwB,KAAK,CAACC,MAAM,CAAC;IAC/D,CAAC,CAAC;EACJ,CAAC,EAAE,EAAE,CAAC;EAEN,OAAO,IAAI;AACb,CAAC;AAACvC,EAAA,CAnDID,cAAc;AAAAyC,EAAA,GAAdzC,cAAc;AAqDpB,eAAeA,cAAc;AAAC,IAAAyC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}